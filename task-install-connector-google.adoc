---
sidebar: sidebar 
permalink: task-install-connector-google.html 
keywords: install connector, google cloud connector installation, google cloud connector, install connector in google cloud, bluexp, gcloud, manual install, create connector, gcp installation, gcp connector 
summary: 直接從 BlueXP 網路型主控台、使用 gCloud 或在您自己的 Linux 主機上安裝軟體來建立 Connector 。 
---
= 在Google Cloud中建立Connector
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
直接從 BlueXP 網路型主控台、使用 gCloud 或在您自己的 Linux 主機上安裝軟體來建立 Connector 。

[role="tabbed-block"]
====
.藍圖
--
.您需要的產品
* 建立 Connector 和 Connector VM 服務帳戶所需的 Google Cloud 權限。
+
link:task-set-up-permissions-google.html["瞭解如何設定 Google Cloud 權限"]

* 符合網路需求的 VPC 和子網路。
+
link:task-set-up-networking-google.html["深入瞭解網路需求"]

* Proxy伺服器的詳細資料、如果需要Proxy才能從Connector存取網際網路。


.步驟
. 單擊 *Connector* 下拉列表並選擇 *Add Connector* 。
+
image:screenshot_connector_add.gif["螢幕擷取畫面、會在標題和「新增連接器」動作中顯示「連接器」圖示。"]

. 選擇 * Google Cloud Platform * 做為雲端供應商。
. 在「*部署連接器*」頁面上、檢閱您需要的詳細資料。您有兩種選擇：
+
.. 按一下*繼續*、使用產品內建指南準備部署。產品內建指南中的每個步驟都包含文件本頁所含的資訊。
.. 如果您已依照本頁的步驟準備好、請按一下*跳至部署*。


. 依照精靈中的步驟建立連接器：
+
** 如果出現提示、請登入您的 Google 帳戶、該帳戶應有建立虛擬機器執行個體所需的權限。
+
這份表單由 Google 擁有及託管。您的認證資料不會提供給 NetApp 。

** *詳細資料*：輸入虛擬機器執行個體的名稱、指定標籤、選取專案、然後選取具有必要權限的服務帳戶（詳細資料請參閱上節）。
** * 位置 * ：指定執行個體的區域、區域、 VPC 和子網路。
** * 網路 * ：選擇是否啟用公用 IP 位址、並選擇性地指定 Proxy 組態。
** * 防火牆原則 * ：選擇是否要建立新的防火牆原則，或是選擇允許所需輸入和輸出規則的現有防火牆原則。
+
link:reference-ports-gcp.html["Google Cloud中的防火牆規則"]

** *審查*：請檢閱您的選擇、確認您的設定正確無誤。


. 按一下「 * 新增 * 」。
+
執行個體應在 7 分鐘內就緒。您應該留在頁面上、直到程序完成為止。



.結果
程序完成後、即可從 BlueXP 使用 Connector 。

--
.gCloud
--
.您需要的產品
* 建立 Connector 和 Connector VM 服務帳戶所需的 Google Cloud 權限。
+
link:task-set-up-permissions-google.html["瞭解如何設定 Google Cloud 權限"]

* 符合網路需求的 VPC 和子網路。
+
link:task-set-up-networking-google.html["深入瞭解網路需求"]



.步驟
. 使用您偏好的方法登入gCloud SDK。
+
在我們的範例中、我們會使用已安裝gCloud SDK的本機Shell、但您可以在Google Cloud主控台使用原生Google Cloud Shell。

+
如需Google Cloud SDK的詳細資訊、請參閱 link:https://cloud.google.com/sdk["Google Cloud SDK文件頁面"^]。

. 請確認您以具有上述區段所定義之必要權限的使用者身分登入：
+
[source, bash]
----
gcloud auth list
----
+
輸出應顯示下列項目、其中*使用者帳戶是所需的使用者帳戶、以下列身分登入：

+
[listing]
----
Credentialed Accounts
ACTIVE  ACCOUNT
     some_user_account@domain.com
*    desired_user_account@domain.com
To set the active account, run:
 $ gcloud config set account `ACCOUNT`
Updates are available for some Cloud SDK components. To install them,
please run:
$ gcloud components update
----
. 執行「gCloud運算執行個體create（gCloud compute instances create））”命令：
+
[source, bash]
----
gcloud compute instances create <instance-name>
  --machine-type=n2-standard-4
  --image-project=netapp-cloudmanager
  --image-family=cloudmanager
  --scopes=cloud-platform
  --project=<project>
  --service-account=<service-account>
  --zone=<zone>
  --no-address
  --tags <network-tag>
  --network <network-path>
  --subnet <subnet-path>
  --boot-disk-kms-key <kms-key-path>
----
+
執行個體名稱:: VM執行個體所需的執行個體名稱。
專案:: （選用）您要部署VM的專案。
服務帳戶:: 步驟2輸出中指定的服務帳戶。
區域:: 您要部署VM的區域
無位址:: （選用）不使用外部IP位址（您需要雲端NAT或Proxy才能將流量路由至公有網際網路）
網路標籤:: （選用）新增網路標記、使用標記將防火牆規則連結至連接器執行個體
網路路徑:: （選用）新增要部署連接器的網路名稱（若為共享VPC、您需要完整路徑）
子網路路徑:: （選用）新增要部署連接器的子網路名稱（對於共享VPC、您需要完整路徑）
kms-key-path:: （選用）新增KMS金鑰以加密連接器的磁碟（也需要套用IAM權限）
+
--
如需這些旗標的詳細資訊、請參閱 link:https://cloud.google.com/sdk/gcloud/reference/compute/instances/create["Google Cloud Compute SDK文件"^]。

--


+
執行命令會使用NetApp黃金映像部署Connector。Connector 執行個體和軟體應在大約五分鐘內執行。

. 從連線至 Connector 執行個體的主機開啟網頁瀏覽器、然後輸入下列 URL ：
+
https://[]

. 登入後、設定 Connector ：
+
.. 指定與 Connector 相關聯的 BlueXP 帳戶。
+
link:concept-netapp-accounts.html["瞭解 BlueXP 帳戶"]。

.. 輸入系統名稱。




.結果
Connector 現在已安裝、並使用您的 BlueXP 帳戶進行設定。

開啟網頁瀏覽器、前往 https://["BlueXP主控台"^] 開始使用Connector with BlueXP。

--
.手動安裝
--
.您需要的產品
* 安裝Connector的root權限。
* Proxy伺服器的詳細資料、如果需要Proxy才能從Connector存取網際網路。
+
您可以選擇在安裝後設定Proxy伺服器、但需要重新啟動Connector。

* CA 簽署的憑證（如果 Proxy 伺服器使用 HTTPS 或 Proxy 是攔截 Proxy ）。


.關於這項工作
* 安裝會安裝 AWS 命令列工具（ awscli ）、以啟用 NetApp 支援的還原程序。
+
如果您收到安裝 awscli 失敗的訊息、您可以放心忽略該訊息。無需使用工具、連接器即可順利運作。

* NetApp 支援網站上提供的安裝程式可能是較早的版本。安裝後、如果有新版本可用、 Connector 會自動自行更新。


.步驟
. 確認已啟用並執行Docker。
+
[source, cli]
----
sudo systemctl enable docker && sudo systemctl start docker
----
. 如果主機上已設定_http或_https或proxy_系統變數、請將其移除：
+
[source, cli]
----
unset http_proxy
unset https_proxy
----
+
如果您未移除這些系統變數、安裝將會失敗。

. 從下載Connector軟體 https://["NetApp 支援網站"^]，然後將其複製到 Linux 主機。
+
您應該下載「線上」 Connector 安裝程式、以供您的網路或雲端使用。Connector 有獨立的「離線」安裝程式、但僅支援私有模式部署。

. 指派執行指令碼的權限。
+
[source, cli]
----
chmod +x OnCommandCloudManager-<version>
----
+
其中、就是您下載的Connector版本<version> 。

. 執行安裝指令碼。
+
[source, cli]
----
 ./OnCommandCloudManager-<version> --proxy <HTTP or HTTPS proxy server> --cacert <path and file name of a CA-signed certificate>
----
+
-Proxy和--cacert參數是可選的。如果您有Proxy伺服器、則必須輸入所示的參數。安裝程式不會提示您提供Proxy的相關資訊。

+
以下是使用兩個選用參數的命令範例：

+
[source, cli]
----
 ./OnCommandCloudManager-V3.9.26 --proxy https://user:password@10.0.0.30:8080/ --cacert /tmp/cacert/certificate.cer
----
+
-Proxy會使用下列其中一種格式、將Connector設定為使用HTTP或HTTPS Proxy伺服器：

+
** \http://address:port
** \http://username:password@address:port
** \https://address:port
** \https://username:password@address:port


+
-cacert指定用於連接器與Proxy伺服器之間HTTPS存取的CA簽署憑證。只有當您指定 HTTPS Proxy 伺服器或 Proxy 是攔截 Proxy 時、才需要此參數。

. 等待安裝完成。
+
安裝結束時、如果您指定Proxy伺服器、Connector服務（occm）會重新啟動兩次。

. 從連線至 Connector 虛擬機器的主機開啟網頁瀏覽器、然後輸入下列 URL ：
+
https://[]

. 登入後、設定 Connector ：
+
.. 指定與 Connector 相關聯的 BlueXP 帳戶。
.. 輸入系統名稱。
.. 在 * 您是在安全的環境中執行？ * 保持停用限制模式。
+
您應該保持停用受限模式、因為這些步驟說明如何在標準模式中使用 BlueXP 。只有當您擁有安全的環境、而且想要中斷此帳戶與 BlueXP 後端服務的連線時、才應啟用受限模式。如果是這樣、 link:task-quick-start-restricted-mode.html["請依照步驟、以受限模式開始使用 BlueXP"]。

.. 按一下 * 開始 * 。




.結果
Connector 現已安裝、並已使用您的 BlueXP 帳戶進行設定。

.接下來呢？
link:task-provide-permissions-google.html["提供 BlueXP 先前設定的權限"]。

--
====